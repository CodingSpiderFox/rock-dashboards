filter {
    if [alert] {

      mutate {
        rename => {"[alert][signature_id]" => "[rule][id]" }
        rename => {"[alert][rev]" => "[rule][version]" }
        rename => {"[alert][category]" => "[rule][category]" }
        rename => {"[alert][signature]" => "[rule][description]" }
        rename => {"[alert][severity]" => "[event][severity]" }

        add_field => {"[event][kind]" => "alert"}
        add_field => {"[event][action]" => "network-%{[alert][action]}"}
        add_field => {"[event][action]" => "[alert][action]"}

        remove_field => "[alert][action]"
      }

      # Specify ruleset, this is just by convention
      grok { 
        match => {"[rule][description]" => "(?<ruleset>^\w+(\s[\w\[\]]+)?)"}
        add_field => {"[rule][ruleset]" => "[ruleset]"}
        remove_field => ["[ruleset]"]
      }
    }
}
